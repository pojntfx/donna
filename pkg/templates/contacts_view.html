<!DOCTYPE html>
<html lang="en">
{{ template "header.html" . }}

<body>
   {{ template "nav.html" . }}

   <header>
      <div>
         <a href="/contacts">ğŸ”™</a>

         <h2>
            {{ .Entry.FirstName }} {{ .Entry.LastName }} {{ if ne .Entry.Nickname
            ""}} ({{ .Entry.Nickname }}) {{ end }}
         </h2>
      </div>

      <div>
         {{ .Entry.Email }} {{if and (ne .Entry.Email "") (ne .Entry.Pronouns
         "")}}|{{end}} {{ .Entry.Pronouns}}
      </div>
   </header>

   <main>
      <section>
         <dl>
            {{ if .Entry.Birthday.Valid }}
            <dt>âœ¨ Birthday</dt>
            <dd>{{ .Entry.Birthday.Value.Format "2006-01-02" }}</dd>
            {{ end }} {{ if .Entry.Address }}
            <dt>ğŸ“ Address</dt>
            <dd>{{ .Entry.Address }}</dd>
            {{ end }} {{ if .Entry.Notes }}
            <dt>ğŸ“œ Notes</dt>
            <dd>{{ .Entry.Notes }}</dd>
            {{ end }}
         </dl>
      </section>

      <section>
         <header>
            <div>
               <h3>ğŸ’¸ Debts</h3>
            </div>

            <div>
               <a href="/debts/add?id={{ .Entry.ID }}">â• Add debt</a>
            </div>
         </header>

         <main>
            {{ if eq (len .Debts) 0 }}
            <div>
               Manage debts you owe to {{ .Entry.FirstName }} or {{
               .Entry.FirstName }} owes you
            </div>
            {{ else }}
            <ul>
               {{ range .Debts }}
               <li>
                  {{ if le .Amount 0.0 }}You owe {{ $.Entry.FirstName }} {{ Abs
                  .Amount }} {{ .Currency }}{{ else }}{{ $.Entry.FirstName }} owes
                  you {{ Abs .Amount }} {{ .Currency }}{{ end }}{{ if .Description
                  }}: {{ .Description }}{{ else }}.{{ end }}

                  <div>
                     <form action="/debts/settle" method="post"
                        onsubmit="return confirm('Are you sure you want to settle this debt?')">
                        <input type="hidden" name="contact_id" value="{{ $.Entry.ID }}" />
                        <input type="hidden" name="id" value="{{ .ID }}" />

                        <input type="submit" value="âœ”ï¸ Settle debt" />
                     </form>

                     <a href="/debts/edit?id={{ .ID }}&contact_id={{ $.Entry.ID }}">âœï¸ Edit debt</a>
                  </div>
               </li>
               {{ end }}
            </ul>
            {{ end }}
         </main>
      </section>

      <section>
         <header>
            <div>
               <h3>ğŸ“… Activities</h3>
            </div>

            <div>
               <a href="/activities/add?id={{ .Entry.ID }}">â• Add activity</a>
            </div>
         </header>

         <main>
            {{ if eq (len .Activities) 0 }}
            <div>
               No activities with {{ .Entry.FirstName }} yet.
            </div>
            {{ else }}
            <ul>
               {{ range .Activities }}
               <li>
                  <div>
                     <h3>
                        <a href="/activities/view?id={{ .LogID }}">{{ .Name }}</a>
                     </h3>

                     <div>
                        Date: {{ .Date.Format "2006-01-02" }} | Description: {{ .Description }}
                     </div>
                  </div>

                  <div>
                     <form action="/activities/delete" method="post"
                        onsubmit="return confirm('Are you sure you want to delete this activity?')">
                        <input type="hidden" name="contact_id" value="{{ $.Entry.ID }}" />
                        <input type="hidden" name="id" value="{{ .LogID }}" />

                        <input type="submit" value="ğŸ—‘ï¸ Delete activity" />
                     </form>

                     <a href="/activities/edit?id={{ .LogID }}&contact_id={{ $.Entry.ID }}">âœï¸ Edit activity</a>
                  </div>
               </li>
               {{ end }}
            </ul>
            {{ end }}
         </main>
      </section>


      <form id="delete" action="/contacts/delete?id={{ .Entry.ID }}" method="post"
         onsubmit="return confirm('Are you sure you want to delete this contact?')"></form>

      <div>
         <input type="submit" value="ğŸ—‘ï¸ Delete" form="delete" />

         <a href="/contacts/edit?id={{ .Entry.ID }}">âœï¸ Edit</a>
      </div>
   </main>

   {{ template "footer.html" . }}
</body>

</html>